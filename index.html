<!doctype html>
<html lang="th" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>แบบประเมินการฝึกอบรมการดูแลผู้ป่วยแบบประคับประคอง</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <style>
    * \{ font-family: 'Sarabun', sans-serif; \}
    .likert-option \{ transition: all 0.2s ease; \}
    .likert-option:hover \{ transform: scale(1.05); \}
    .likert-option.selected \{ transform: scale(1.1); \}
    .section-card \{ animation: fadeInUp 0.5s ease-out; \}
    @keyframes fadeInUp \{
      from \{ opacity: 0; transform: translateY(20px); \}
      to \{ opacity: 1; transform: translateY(0); \}
    \}
    .progress-bar \{ transition: width 0.3s ease; \}
    input[type="radio"]:checked + label \{ border-color: #0d9488; background-color: #f0fdfa; \}
    .question-row:nth-child(odd) \{ background-color: #f8fafc; \}
    .question-row:nth-child(even) \{ background-color: #ffffff; \}
  </style>
  <style>body \{ box-sizing: border-box; \}</style>
 </head>
 <body class="h-full bg-gradient-to-br from-teal-50 via-white to-cyan-50">
  <div id="app-wrapper" class="h-full w-full overflow-auto">
   <!-- Header -->
   <header class="bg-gradient-to-r from-teal-600 to-cyan-600 text-white py-6 px-4 shadow-lg">
    <div class="max-w-4xl mx-auto text-center">
     <div class="flex items-center justify-center gap-3 mb-3">
      <svg class="w-10 h-10" fill="currentColor" viewbox="0 0 24 24">
       <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z" />
      </svg>
      <div>
       <h1 id="main-title" class="text-xl md:text-2xl font-bold">แบบประเมิน โครงการฝึกอบรมการดูแลผู้ป่วยแบบประคับประคองขั้นพื้นฐาน สำหรับพยาบาลประจำหอผู้ป่วย (หลักสูตร 5 วัน)</h1>
       <p id="period-text" class="text-teal-100 text-sm mt-2">เลือกระยะเวลาประเมิน</p>
      </div>
     </div>
    </div>
   </header><!-- Period Selection Modal -->
   <div id="period-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-2xl p-8 shadow-2xl max-w-md w-full mx-4">
     <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">เลือกระยะเวลาประเมิน</h2>
     <p class="text-gray-600 mb-6 text-center">กรุณาเลือกว่านี่คือการประเมินในช่วงไหนของการฝึกอบรม</p>
     <div class="space-y-3"><button onclick="selectPeriod('ก่อนการอบรม')" class="w-full px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white font-medium rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all shadow-lg hover:shadow-xl text-lg"> ก่อนการอบรม (Pre-test) </button> <button onclick="selectPeriod('หลังการอบรม (5 วัน)')" class="w-full px-6 py-4 bg-gradient-to-r from-emerald-500 to-emerald-600 text-white font-medium rounded-xl hover:from-emerald-600 hover:to-emerald-700 transition-all shadow-lg hover:shadow-xl text-lg"> หลังการอบรม (5 วัน) (Post-test 1) </button> <button onclick="selectPeriod('หลังการอบรม (1 เดือน)')" class="w-full px-6 py-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white font-medium rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all shadow-lg hover:shadow-xl text-lg"> หลังการอบรม (1 เดือน) (Post-test 2) </button>
     </div>
    </div>
   </div><!-- Progress Bar -->
   <div class="sticky top-0 z-40 bg-white shadow-sm">
    <div class="max-w-4xl mx-auto px-4 py-3">
     <div class="flex items-center justify-between text-sm text-gray-600 mb-2">
      <span>ความคืบหน้า</span> <span id="progress-text">ส่วนที่ 1 / 3</span>
     </div>
     <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
      <div id="progress-bar" class="progress-bar h-full bg-gradient-to-r from-teal-500 to-cyan-500 rounded-full" style="width: 33%"></div>
     </div>
    </div>
   </div>
   <main class="max-w-4xl mx-auto px-4 py-6 pb-20">
    <!-- Section 1: Personal Information -->
    <section id="section1" class="section-card bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-6">
     <div class="flex items-center gap-3 mb-4">
      <div class="w-10 h-10 bg-teal-100 rounded-full flex items-center justify-center">
       <span class="text-teal-600 font-bold">1</span>
      </div>
      <h2 class="text-xl md:text-2xl font-bold text-gray-800">แบบบันทึกข้อมูลส่วนบุคคล</h2>
     </div>
     <p class="text-gray-600 mb-6 pl-13 border-l-4 border-teal-200 ml-5 pl-4">โปรดกรอกข้อมูลส่วนบุคคลของท่านให้ครบถ้วนและถูกต้อง</p>
     <div class="space-y-6">
      <!-- Gender -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">1. เพศ <span class="text-red-500">*</span></label>
       <div class="flex flex-wrap gap-4">
        <label class="flex items-center gap-2 cursor-pointer"> <input type="radio" name="gender" value="ชาย" class="w-5 h-5 text-teal-600 focus:ring-teal-500"> <span class="text-gray-700">ชาย</span> </label> <label class="flex items-center gap-2 cursor-pointer"> <input type="radio" name="gender" value="หญิง" class="w-5 h-5 text-teal-600 focus:ring-teal-500"> <span class="text-gray-700">หญิง</span> </label>
       </div>
      </div><!-- Age -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">2. อายุของท่าน (ปี) <span class="text-red-500">*</span></label> <input type="number" name="age" min="20" max="70" placeholder="เช่น 35" class="w-full md:w-48 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-teal-500 focus:ring-2 focus:ring-teal-200 transition-all">
      </div><!-- Marital Status -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">3. สถานภาพสมรสของท่าน <span class="text-red-500">*</span></label>
       <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
        <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="marital" value="โสด" class="w-5 h-5 text-teal-600"> <span>โสด</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="marital" value="สมรส" class="w-5 h-5 text-teal-600"> <span>สมรส</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="marital" value="หย่าร้าง" class="w-5 h-5 text-teal-600"> <span>หย่าร้าง</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="marital" value="หม้าย" class="w-5 h-5 text-teal-600"> <span>หม้าย</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="marital" value="แยก" class="w-5 h-5 text-teal-600"> <span>แยกกันอยู่</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="marital" value="อื่นๆ" class="w-5 h-5 text-teal-600"> <span>อื่น ๆ</span> </label>
       </div><input type="text" name="marital_other" placeholder="ระบุสถานภาพอื่น ๆ" class="mt-3 w-full md:w-64 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-teal-500 hidden">
      </div><!-- Education -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">4. ระดับการศึกษาสูงสุด <span class="text-red-500">*</span></label>
       <div class="flex flex-wrap gap-3">
        <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="education" value="ปริญญาตรี" class="w-5 h-5 text-teal-600"> <span>ปริญญาตรี</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="education" value="ปริญญาโท" class="w-5 h-5 text-teal-600"> <span>ปริญญาโท</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="education" value="ปริญญาเอก" class="w-5 h-5 text-teal-600"> <span>ปริญญาเอก</span> </label>
       </div>
      </div><!-- Hospital Level -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">5. ระดับโรงพยาบาลที่ปฏิบัติงาน <span class="text-red-500">*</span></label>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="hospital" value="โรงพยาบาลชุมชน" class="w-5 h-5 text-teal-600"> <span>โรงพยาบาลชุมชน</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="hospital" value="โรงพยาบาลทั่วไป" class="w-5 h-5 text-teal-600"> <span>โรงพยาบาลทั่วไป</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="hospital" value="โรงพยาบาลศูนย์" class="w-5 h-5 text-teal-600"> <span>โรงพยาบาลศูนย์</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="hospital" value="อื่นๆ" class="w-5 h-5 text-teal-600"> <span>อื่น ๆ</span> </label>
       </div><input type="text" name="hospital_other" placeholder="ระบุโรงพยาบาลอื่น ๆ" class="mt-3 w-full md:w-64 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-teal-500 hidden">
      </div><!-- Position -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">6. ตำแหน่งงาน <span class="text-red-500">*</span></label>
       <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
        <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="position" value="หัวหน้ากลุ่มงาน/หัวหน้างาน" class="w-5 h-5 text-teal-600"> <span>หัวหน้ากลุ่มงาน/หัวหน้างาน</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="position" value="หัวหน้าหอผู้ป่วย/ศูนย์" class="w-5 h-5 text-teal-600"> <span>หัวหน้าหอผู้ป่วย/ศูนย์</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="position" value="รองหัวหน้าหอผู้ป่วย/ศูนย์" class="w-5 h-5 text-teal-600"> <span>รองหัวหน้าหอผู้ป่วย/ศูนย์</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="position" value="พยาบาลวิชาชีพปฏิบัติงาน" class="w-5 h-5 text-teal-600"> <span>พยาบาลวิชาชีพปฏิบัติงาน</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all md:col-span-2"> <input type="radio" name="position" value="อื่นๆ" class="w-5 h-5 text-teal-600"> <span>อื่น ๆ</span> </label>
       </div><input type="text" name="position_other" placeholder="ระบุตำแหน่งอื่น ๆ" class="mt-3 w-full md:w-64 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-teal-500 hidden">
      </div><!-- Experience -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">7. ประสบการณ์การปฏิบัติงานการพยาบาลทั้งหมด (ปี) <span class="text-red-500">*</span></label> <input type="number" name="experience" min="0" max="50" step="0.5" placeholder="เช่น 10.5" class="w-full md:w-48 px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-teal-500 focus:ring-2 focus:ring-teal-200 transition-all">
      </div><!-- Palliative Experience -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">8. เคยมีประสบการณ์การดูแลผู้ป่วยแบบประคับประคองหรือไม่ <span class="text-red-500">*</span></label>
       <div class="flex gap-4">
        <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="palliative_exp" value="เคย" class="w-5 h-5 text-teal-600"> <span>เคย</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="palliative_exp" value="ไม่เคย" class="w-5 h-5 text-teal-600"> <span>ไม่เคย</span> </label>
       </div>
      </div><!-- Palliative Training -->
      <div class="form-group">
       <label class="block text-gray-700 font-medium mb-3">9. เคยได้รับการอบรมการดูแลผู้ป่วยแบบประคับประคองหรือไม่ <span class="text-red-500">*</span></label>
       <div class="flex gap-4 mb-3">
        <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="palliative_training" value="เคย" class="w-5 h-5 text-teal-600"> <span>เคย</span> </label> <label class="flex items-center gap-2 cursor-pointer p-3 border-2 border-gray-200 rounded-xl hover:border-teal-300 transition-all"> <input type="radio" name="palliative_training" value="ไม่เคย" class="w-5 h-5 text-teal-600"> <span>ไม่เคย</span> </label>
       </div>
       <div id="training-course-wrapper" class="hidden">
        <label class="block text-gray-600 text-sm mb-2">ระบุชื่อหลักสูตรที่เคยอบรม:</label> <input type="text" name="training_course" placeholder="ชื่อหลักสูตร" class="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-teal-500">
       </div>
      </div>
     </div>
     <div class="mt-8 flex justify-end">
      <button onclick="goToSection(2)" class="px-8 py-3 bg-gradient-to-r from-teal-500 to-cyan-500 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-600 transition-all shadow-lg hover:shadow-xl flex items-center gap-2"> ถัดไป 
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
       </svg></button>
     </div>
    </section><!-- Section 2: Palliative Care Competency Assessment -->
    <section id="section2" class="section-card bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-6 hidden">
     <div class="flex items-center gap-3 mb-4">
      <div class="w-10 h-10 bg-cyan-100 rounded-full flex items-center justify-center">
       <span class="text-cyan-600 font-bold">2</span>
      </div>
      <h2 class="text-xl md:text-2xl font-bold text-gray-800">แบบประเมินการรับรู้สมรรถนะการดูแลแบบประคับประคอง</h2>
     </div>
     <div class="text-gray-600 mb-6 pl-4 border-l-4 border-cyan-200 ml-5">
      <p class="mb-3">แบบประเมินนี้วัดระดับการรับรู้สมรรถนะของท่านในการให้การพยาบาลผู้ป่วยระยะประคับประคอง</p>
      <p>โปรดประเมินความสามารถของท่านในแต่ละรายการตามความเป็นจริง โดยทำเครื่องหมายในช่องที่ตรงกับความเห็นของท่าน</p>
     </div><!-- Likert Scale Legend -->
     <div class="bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-4 mb-6">
      <h3 class="font-medium text-gray-700 mb-3">ระดับความมั่นใจ:</h3>
      <div class="grid grid-cols-3 md:grid-cols-6 gap-2 text-sm">
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-gray-400">
         0
        </div>
        <div class="text-gray-600 text-xs">
         ไม่มั่นใจเลย
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-red-400">
         1
        </div>
        <div class="text-gray-600 text-xs">
         มั่นใจน้อยมาก
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-orange-400">
         2
        </div>
        <div class="text-gray-600 text-xs">
         มั่นใจน้อย
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-yellow-500">
         3
        </div>
        <div class="text-gray-600 text-xs">
         มั่นใจปานกลาง
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-lime-500">
         4
        </div>
        <div class="text-gray-600 text-xs">
         มั่นใจมาก
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-green-500">
         5
        </div>
        <div class="text-gray-600 text-xs">
         มั่นใจมากที่สุด
        </div>
       </div>
      </div>
     </div><!-- Questions Container -->
     <div id="part2-questions" class="space-y-0 border border-gray-200 rounded-xl overflow-hidden">
      <!-- Questions will be generated by JavaScript -->
     </div><!-- Score Summary for Part 2 -->
     <div id="part2-summary" class="mt-6 p-4 bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl">
      <div class="flex items-center justify-between">
       <span class="font-medium text-gray-700">คะแนนเฉลี่ยส่วนที่ 2:</span> <span id="part2-avg" class="text-2xl font-bold text-teal-600">-</span>
      </div>
      <div class="mt-2 h-3 bg-gray-200 rounded-full overflow-hidden">
       <div id="part2-bar" class="h-full bg-gradient-to-r from-teal-500 to-cyan-500 transition-all duration-300" style="width: 0%"></div>
      </div>
     </div>
     <div class="mt-8 flex justify-between">
      <button onclick="goToSection(1)" class="px-6 py-3 border-2 border-gray-300 text-gray-600 font-medium rounded-xl hover:border-teal-500 hover:text-teal-600 transition-all flex items-center gap-2">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
       </svg> ย้อนกลับ </button> <button onclick="goToSection(3)" class="px-8 py-3 bg-gradient-to-r from-teal-500 to-cyan-500 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-600 transition-all shadow-lg hover:shadow-xl flex items-center gap-2"> ถัดไป 
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
       </svg></button>
     </div>
    </section><!-- Section 3: Person-Centered Care Assessment -->
    <section id="section3" class="section-card bg-white rounded-2xl shadow-lg p-6 md:p-8 mb-6 hidden">
     <div class="flex items-center gap-3 mb-4">
      <div class="w-10 h-10 bg-emerald-100 rounded-full flex items-center justify-center">
       <span class="text-emerald-600 font-bold">3</span>
      </div>
      <h2 class="text-xl md:text-2xl font-bold text-gray-800">แบบประเมินการดูแลแบบยึดบุคคลเป็นศูนย์กลาง</h2>
     </div>
     <div class="text-gray-600 mb-6 pl-4 border-l-4 border-emerald-200 ml-5">
      <p class="mb-3">แบบสอบถามนี้มีวัตถุประสงค์เพื่อวัดระดับการดูแลที่เน้นผู้ป่วยเป็นศูนย์กลางภายในหน่วยงาน ตามประสบการณ์และการรับรู้ของบุคลากร</p>
      <p>โปรดพิจารณาว่าข้อความแต่ละข้อสอดคล้องกับประสบการณ์ของท่านมากน้อยเพียงใด</p>
     </div><!-- Likert Scale Legend for Part 3 -->
     <div class="bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl p-4 mb-6">
      <h3 class="font-medium text-gray-700 mb-3">ระดับความคิดเห็น:</h3>
      <div class="grid grid-cols-5 gap-2 text-sm">
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-red-500">
         1
        </div>
        <div class="text-gray-600 text-xs">
         ไม่เห็นด้วยอย่างยิ่ง
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-orange-500">
         2
        </div>
        <div class="text-gray-600 text-xs">
         ไม่เห็นด้วย
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-yellow-500">
         3
        </div>
        <div class="text-gray-600 text-xs">
         ไม่แน่ใจ
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-lime-500">
         4
        </div>
        <div class="text-gray-600 text-xs">
         เห็นด้วย
        </div>
       </div>
       <div class="text-center p-2 bg-white rounded-lg shadow-sm">
        <div class="font-bold text-green-500">
         5
        </div>
        <div class="text-gray-600 text-xs">
         เห็นด้วยอย่างยิ่ง
        </div>
       </div>
      </div>
     </div><!-- Questions Container for Part 3 -->
     <div id="part3-questions" class="space-y-0 border border-gray-200 rounded-xl overflow-hidden">
      <!-- Questions will be generated by JavaScript -->
     </div><!-- Score Summary for Part 3 -->
     <div id="part3-summary" class="mt-6 p-4 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl">
      <div class="flex items-center justify-between">
       <span class="font-medium text-gray-700">คะแนนเฉลี่ยส่วนที่ 3:</span> <span id="part3-avg" class="text-2xl font-bold text-emerald-600">-</span>
      </div>
      <div class="mt-2 h-3 bg-gray-200 rounded-full overflow-hidden">
       <div id="part3-bar" class="h-full bg-gradient-to-r from-emerald-500 to-teal-500 transition-all duration-300" style="width: 0%"></div>
      </div>
     </div>
     <div class="mt-8 flex justify-between">
      <button onclick="goToSection(2)" class="px-6 py-3 border-2 border-gray-300 text-gray-600 font-medium rounded-xl hover:border-teal-500 hover:text-teal-600 transition-all flex items-center gap-2">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
       </svg> ย้อนกลับ </button> <button id="submit-btn" onclick="submitForm()" class="px-8 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-medium rounded-xl hover:from-emerald-600 hover:to-teal-600 transition-all shadow-lg hover:shadow-xl flex items-center gap-2">
       <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
       </svg> ส่งแบบประเมิน </button>
     </div>
    </section><!-- Success Message -->
    <section id="success-section" class="section-card bg-white rounded-2xl shadow-lg p-8 text-center hidden">
     <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6">
      <svg class="w-10 h-10 text-green-500" fill="none" stroke="currentColor" viewbox="0 0 24 24">
       <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
      </svg>
     </div>
     <h2 class="text-2xl font-bold text-gray-800 mb-4">ส่งแบบประเมินเรียบร้อยแล้ว!</h2>
     <p class="text-gray-600 mb-3">ขอบคุณที่สละเวลาทำแบบประเมิน</p>
     <p id="period-confirmation" class="text-teal-600 font-medium mb-6"></p><!-- Final Score Summary -->
     <div class="bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl p-6 mb-6">
      <h3 class="font-bold text-gray-800 mb-4">สรุปคะแนนของท่าน</h3>
      <div class="grid grid-cols-2 gap-4">
       <div class="bg-white rounded-lg p-4 shadow-sm">
        <div class="text-sm text-gray-600">
         ส่วนที่ 2: สมรรถนะการดูแล
        </div>
        <div id="final-part2" class="text-3xl font-bold text-teal-600 mt-2">
         -
        </div>
        <div class="text-xs text-gray-500">
         จากคะแนนเต็ม 5
        </div>
       </div>
       <div class="bg-white rounded-lg p-4 shadow-sm">
        <div class="text-sm text-gray-600">
         ส่วนที่ 3: การดูแลยึดบุคคล
        </div>
        <div id="final-part3" class="text-3xl font-bold text-emerald-600 mt-2">
         -
        </div>
        <div class="text-xs text-gray-500">
         จากคะแนนเต็ม 5
        </div>
       </div>
      </div>
     </div><button onclick="resetForm()" class="px-8 py-3 bg-gradient-to-r from-teal-500 to-cyan-500 text-white font-medium rounded-xl hover:from-teal-600 hover:to-cyan-600 transition-all shadow-lg"> ทำแบบประเมินใหม่ </button>
    </section>
   </main><!-- Loading Overlay -->
   <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-2xl p-8 text-center">
     <div class="animate-spin w-12 h-12 border-4 border-teal-500 border-t-transparent rounded-full mx-auto mb-4"></div>
     <p class="text-gray-600">กำลังบันทึกข้อมูล...</p>
    </div>
   </div><!-- Toast Message -->
   <div id="toast" class="fixed bottom-4 right-4 bg-red-500 text-white px-6 py-3 rounded-xl shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 z-50">
    <span id="toast-message"></span>
   </div>
  </div>
  
  <script>
    /**
     * GitHub Pages version — save to Google Sheets via Google Apps Script Web App
     * 1) Deploy GAS as Web App (Execute as: Me, Who has access: Anyone)
     * 2) Put the Web App URL below
     */
    const GOOGLE_SHEET_ID = "1RV1Y8iB-ftuKKgfhUfSO5V6UO1QpviYvFk9d0V8s19I";
    const GAS_WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxO_UmAWWUBZPL4c9HVUunHmxh9kiFOuZHbPoFjbooHCGfc3sqiEuMdiQ6OuwZBmqtl/exec";

    function mapPeriodToSheetName(period) {
      // ตามที่กำหนด
      if (period === "ก่อนการอบรม") return "pretest";
      if (period === "หลังการอบรม (5 วัน)") return "postest";
      if (period === "หลังการอบรม (1 เดือน)") return "postest 2";
      return "pretest";
    }

    async function appendToGoogleSheet(payload) {
      if (!GAS_WEB_APP_URL || GAS_WEB_APP_URL.includes("PUT_YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL_HERE")) {
        throw new Error("ยังไม่ได้ตั้งค่า GAS_WEB_APP_URL");
      }

      const res = await fetch(GAS_WEB_APP_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      });

      if (!res.ok) throw new Error("HTTP " + res.status);
      const data = await res.json().catch(() => ({}));
      if (!data || data.ok !== true) {
        throw new Error(data && data.error ? data.error : "บันทึกไม่สำเร็จ");
      }
      return data;
    }
  </script>

<script>
    // Default configuration
    const defaultConfig = \{
      form_title: 'แบบประเมิน โครงการฝึกอบรมการดูแลผู้ป่วยแบบประคับประคองขั้นพื้นฐาน สำหรับพยาบาลประจำหอผู้ป่วย (หลักสูตร 5 วัน)',
      organization_name: '',
      primary_color: '#0d9488',
      secondary_color: '#06b6d4',
      background_color: '#f0fdfa',
      text_color: '#1f2937',
      accent_color: '#10b981'
    \};

    let config = \{ ...defaultConfig \};
    let currentSection = 1;
    let assessmentPeriod = '';
    let part2Scores = \{\};
    let part3Scores = \{\};

    // Part 2 Questions (65 new questions)
    const part2Questions = [
      "ประเมินอาการปวดในผู้ป่วยระยะประคับประคองโดยพิจารณาองค์ประกอบต่อไปนี้ทั้งหมด: ลักษณะ ระยะเวลา ตำแหน่ง ความรุนแรง ปัจจัยกระตุ้นและปัจจัยบรรเทา",
      "ประเมินอาการปวดในผู้ป่วยระยะประคับประคองที่ไม่สามารถสื่อสารได้",
      "ใช้การวิธีการให้ยาอย่างมีประสิทธิภาพเพื่อบรรเทาอาการปวดในผู้ป่วยระยะประคับประคอง",
      "ใช้วิธีแบบไม่ใช้ยาและการบำบัดเสริมอื่นเพื่อบรรเทาอาการปวดในผู้ป่วยระยะประคับประคอง",
      "ประเมินผลข้างเคียงที่เกี่ยวข้องกับยาแก้ปวดได้ตั้งแต่ระยะเริ่มต้น",
      "ให้การดูแลอย่างมีประสิทธิภาพเพื่อบรรเทาอาการคลื่นไส้และอาเจียนในผู้ป่วยระยะประคับประคอง",
      "ให้การดูแลอย่างมีประสิทธิภาพเพื่อบรรเทาอาการท้องผูกในผู้ป่วยระยะประคับประคอง",
      "ให้การดูแลอย่างมีประสิทธิภาพเพื่อบรรเทาอาการอ่อนเพลียในผู้ป่วยระยะประคับประคอง",
      "ให้การดูแลอย่างมีประสิทธิภาพเพื่อบรรเทาอาการหายใจลำบากในผู้ป่วยระยะประคับประคอง",
      "ดูแลช่องปากอย่างเหมาะสมเพื่อส่งเสริมความสุขสบายในผู้ป่วยระยะประคับประคอง",
      "ประเมินภาวะเพ้อสับสนในผู้ป่วยระยะประคับประคองได้ตั้งแต่ระยะเริ่มต้น",
      "ประเมินภาวะซึมเศร้าในผู้ป่วยระยะประคับประคองและครอบครัว",
      "ให้การดูแลอย่างมีประสิทธิภาพเพื่อลดความทุกข์ทางจิตใจในผู้ป่วยระยะประคับประคองและครอบครัว",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองและครอบครัวให้เผชิญกับความเครียดที่เกี่ยวข้องกับการเจ็บป่วย",
      "ให้การสนับสนุนผู้ป่วยระยะประคับประคองและครอบครัวเมื่อเผชิญกับความโศกเศร้า",
      "ประเมินผลกระทบของโรคที่คุกคามชีวิตต่อพลวัตของครอบครัว",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองและครอบครัวในการรักษาประเพณีทางวัฒนธรรมแม้จะมีความเจ็บป่วย",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองและครอบครัวในการระบุทรัพยากรส่วนบุคคลเพื่อรับมือกับปัญหาที่เกี่ยวข้องกับโรคที่คุกคามชีวิต",
      "ส่งเสริมการสื่อสารระหว่างผู้ป่วยระยะประคับประคองและสมาชิกในครอบครัวเมื่อเกิดความขัดแย้ง",
      "ส่งต่อผู้ป่วยระยะประคับประคองและครอบครัวไปยังแหล่งสนับสนุนที่เหมาะสมเพื่อตอบสนองความต้องการทางสังคม",
      "ประเมินความต้องการทางจิตวิญญาณของผู้ป่วยระยะประคับประคองและครอบครัว",
      "รับรู้สัญญาณของความทุกข์ทางจิตวิญญาณในผู้ป่วยระยะประคับประคองและครอบครัว",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองและครอบครัวในการค้นหาความหวังที่หลากหลายเมื่อพวกเขาแสดงสัญญาณของความสิ้นหวัง",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองในการค้นหาความหมายของประสบการณ์การเจ็บป่วยของพวกเขา",
      "ปรับการพยาบาลให้สอดคล้องกับความเชื่อทางจิตวิญญาณของผู้ป่วยระยะประคับประคองและครอบครัว",
      "ประเมินความต้องการที่เกี่ยวข้องกับกิจกรรมในชีวิตประจำวันในผู้ป่วยระยะประคับประคอง",
      "ประเมินความต้องการการสนับสนุนด้านการดูแลผู้ป่วยเพื่อป้องกันภาวะหมดไฟในสมาชิกครอบครัวที่ดูแลผู้ป่วยระยะประคับประคอง",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองในการรักษาความเป็นอิสระในการทำกิจกรรมให้นานที่สุดเท่าที่เป็นไปได้",
      "เสริมสร้างพลังของสมาชิกครอบครัวในการให้การดูแลผู้ป่วยระยะประคับประคอง",
      "ดำเนินการด้วยวิธีที่เหมาะสมเพื่อช่วยบรรเทาภาระของสมาชิกครอบครัวที่ดูแลผู้ป่วยระยะประคับประคอง",
      "ระบุประเด็นทางจริยธรรมที่เกี่ยวข้องกับการดูแลผู้ป่วยระยะประคับประคองได้อย่างทันท่วงที",
      "ให้ข้อมูลแก่ผู้ป่วยระยะประคับประคองเกี่ยวกับประเด็นทางกฎหมายที่เกี่ยวข้องกับโรคที่คุกคามชีวิต",
      "ช่วยเหลือผู้ป่วยระยะประคับประคองในการตัดสินถี่ถ้วนเกี่ยวกับการดูแลในช่วงท้ายของชีวิต",
      "ทำหน้าที่เป็นผู้พิทักษ์สิทธิของผู้ป่วยระยะประคับประคองและครอบครัวกับสมาชิกคนอื่นๆ ในทีมสุขภาพ",
      "ทำหน้าที่เป็นผู้พิทักษ์สิทธิของผู้ป่วยระยะประคับประคองเมื่อมีความเห็นแตกต่างกันกับครอบครัวเกี่ยวกับประเด็นการดูแล",
      "มีส่วนร่วมอย่างแข็งขันในการอภิปรายเกี่ยวกับสถานการณ์ทางคลินิกของผู้ป่วยระยะประคับประคองในระหว่างการประชุมทีมสหวิชาชีพ",
      "ส่งเสริมการสื่อสารระหว่างบุคลากรสุขภาพเกี่ยวกับผู้ป่วยระยะประคับประคองเพื่อสนับสนุนความต่อเนื่องของการดูแล",
      "ส่งเสริมการสื่อสารระหว่างผู้ป่วยระยะประคับประคอง ครอบครัว และบุคลากรสุขภาพเพื่อให้มั่นใจในการแลกเปลี่ยนข้อมูล",
      "ส่งเสริมการสื่อสารระหว่างบุคลากรสุขภาพเมื่อเกิดความขัดแย้งในการดูแลผู้ป่วยระยะประคับประคองและครอบครัว",
      "ส่งเสริมความร่วมมือของสหสาขาวิชาชีพในการดูแลผู้ป่วยระยะประคับประคองและครอบครัว",
      "ท่านรับรู้ว่าความเชื่อส่วนบุคคลและทางวิชาชีพของท่านอาจมีอิทธิพลต่อการดูแลที่ท่านให้แก่ผู้ป่วยระยะประคับประคองและครอบครัวอย่างไร",
      "ท่านเผชิญกับการสูญเสียและความโศกเศร้าที่เกี่ยวข้องกับการดูแลผู้ป่วยระยะประคับประคองและครอบครัว",
      "ระบุปัจจัยกระตุ้นที่ส่งผลกระทบเมื่อท่านให้การดูแลผู้ป่วยระยะประคับประคองและครอบครัว",
      "ระบุแหล่งประโยชน์ของท่านเองเพื่อจัดการกับความเครียดที่เกี่ยวข้องกับการดูแลผู้ป่วยระยะประคับประคองและครอบครัว",
      "สนทนาเรื่องความตายและการจากไปกับผู้ป่วยระยะประคับประคองและครอบครัว",
      "ให้การดูแลอย่างมีประสิทธิภาพเพื่อบรรเทาอาการปวดในผู้ป่วยระยะประคับประคองในช่วงชั่วโมงสุดท้ายของชีวิต",
      "ท่านให้การดูแลอย่างมีประสิทธิภาพเพื่อบรรเทาอาการหายใจลำบากในช่วงชั่วโมงสุดท้ายของชีวิต",
      "ท่านสามารถระบุสัญญาณและอาการของระยะใกล้เสียชีวิตในผู้ป่วยระยะประคับประคอง",
      "แสดงความจริงใจในการอยู่เคียงข้างในช่วงชั่วโมงสุดท้ายของชีวิตกับผู้ป่วยระยะประคับประคองและครอบครัว",
      "ส่งเสริมการปฏิบัติทางประเพณี วัฒนธรรม และศาสนาสำหรับผู้ป่วยระยะประคับประคองและครอบครัวในช่วงชั่วโมงสุดท้ายของชีวิต",
      "ให้การดูแลผู้ป่วยและครอบครัวแบบองค์รวม ครอบคลุมทั้งด้านร่างกาย จิตใจ สังคม และจิตวิญญาณ",
      "ประยุกต์ใช้ปรัชญาและเป้าหมายของการดูแลแบบประคับประคองในการปฏิบัติการพยาบาล",
      "ให้การดูแลผู้ป่วยและครอบครัวอย่างต่อเนื่องตั้งแต่เริ่มวินิจฉัยโรคจนถึงภายหลังการเสียชีวิต",
      "ส่งเสริมคุณภาพชีวิตของผู้ป่วยและครอบครัวในทุกช่วงของการเจ็บป่วย",
      "อธิบายกลไกของความปวดและอาการรบกวนอื่นๆ แก่ผู้ป่วยและครอบครัวได้อย่างเข้าใจง่าย",
      "ประเมินอาการรบกวนอื่นๆ ได้อย่างเหมาะสม เช่น อ่อนแรง เบื่ออาหาร นอนไม่หลับ",
      "ประยุกต์ใช้การรักษาทั้งด้วยยาและไม่ใช้ยาเพื่อลดความทุกข์ทรมานและส่งเสริมความสุขสบายของผู้ป่วย",
      "เข้าใจกระบวนการตายและสามารถอธิบายให้ผู้ป่วยและครอบครัวเข้าใจได้",
      "เตรียมผู้ป่วยและครอบครัวต่อการเปลี่ยนแปลงทางร่างกายและจิตใจในระยะสุดท้ายของชีวิต",
      "ดูแลร่างกายผู้ป่วยภายหลังเสียชีวิตอย่างสุภาพ เคารพศักดิ์ศรี และเหมาะสมตามวัฒนธรรม",
      "ประเมินและให้การช่วยเหลือครอบครัวในการเผชิญความสูญเสียทั้งก่อนและหลังผู้ป่วยเสียชีวิต",
      "แยกแยะความเศร้าโศกตามธรรมชาติกับภาวะซึมเศร้าที่ต้องการการรักษา",
      "ส่งต่อครอบครัวไปยังผู้เชี่ยวชาญด้านสุขภาพจิตหรือการให้คำปรึกษาเมื่อจำเป็น",
      "ให้การสนับสนุนครอบครัวในระยะหลังการสูญเสียอย่างต่อเนื่องและเหมาะสม",
      "ใช้ทักษะการสื่อสารเชิงบำบัดในการดูแลผู้ป่วยและครอบครัวอย่างมีประสิทธิผล"
    ];

    // Part 3 Questions (13 questions for person-centered care)
    const part3Questions = [
      "เรามักพูดคุยกันอยู่เสมอเกี่ยวกับวิธีการให้การดูแลที่เน้นผู้ป่วยเป็นศูนย์กลาง",
      "เรามีการประชุมทีมอย่างเป็นทางการเพื่อหารือเกี่ยวกับการดูแลผู้ป่วย",
      "ประวัติชีวิตของผู้ป่วยถูกนำมาใช้อย่างเป็นทางการในแผนการดูแล",
      "คุณภาพของปฏิสัมพันธ์ระหว่างบุคลากรและผู้ป่วยมีความสำคัญมากกว่าการทำงานให้เสร็จ",
      "เรามีอิสระในการปรับเปลี่ยนกิจวัตรการทำงานตามความพึงพอใจของผู้ป่วย",
      "ผู้ป่วยได้รับโอกาสในการมีส่วนร่วมในกิจกรรมประจำวันเฉพาะบุคคล",
      "ท่านไม่มีเวลาเพียงพอที่จะให้การดูแลที่เน้นผู้ป่วยเป็นศูนย์กลาง",
      "สภาพแวดล้อมการทำงานในหน่วยงานให้ความรู้สึกสับสนวุ่นวาย",
      "เราต้องทำงานให้เสร็จก่อนจึงจะให้ความสำคัญกับสภาพแวดล้อมที่อบอุ่นเหมือนบ้าน",
      "หน่วยงานเป็นอุปสรรคที่ทำให้ฉันไม่สามารถให้การดูแลที่เน้นผู้สูงอายุเป็นศูนย์กลางได้",
      "การประเมินความต้องการของผู้สูงอายุถูกดำเนินการเป็นประจำทุกวัน",
      "ผู้ป่วยในหน่วยงานของท่านหาทางเดินไปมาได้ยาก",
      "ผู้ป่วยในหน่วยงานของท่านสามารถเข้าถึงพื้นที่กลางภายนอกได้ตามที่ต้องการ"
    ];

    function selectPeriod(period) \{
      assessmentPeriod = period;
      document.getElementById('period-modal').classList.add('hidden');
      document.getElementById('period-text').textContent = `ระยะเวลาประเมิน: $\{period\}`;
      generatePart2Questions();
      generatePart3Questions();
    \}

    // Generate Part 2 Questions
    function generatePart2Questions() \{
      const container = document.getElementById('part2-questions');
      container.innerHTML = '';
      
      part2Questions.forEach((question, index) => \{
        const questionNum = index + 1;
        const row = document.createElement('div');
        row.className = 'question-row p-4 border-b border-gray-100 last:border-b-0';
        row.innerHTML = `
          <div class="flex flex-col lg:flex-row lg:items-center gap-4">
            <div class="flex-1">
              <span class="font-medium text-gray-800">$\{questionNum\}. </span>
              <span class="text-gray-700">$\{question\}</span>
            </div>
            <div class="flex gap-2 justify-end flex-shrink-0">
              $\{[0,1,2,3,4,5].map(score => `
                <label class="likert-option cursor-pointer">
                  <input type="radio" name="p2q$\{questionNum\}" value="$\{score\}" class="sr-only" onchange="updatePart2Score($\{questionNum\}, $\{score\})">
                  <div class="w-10 h-10 rounded-full border-2 border-gray-300 flex items-center justify-center text-sm font-bold text-gray-500 hover:border-teal-500 hover:text-teal-600 transition-all $\{getScoreColor(score, 6)\}">
                    $\{score\}
                  </div>
                </label>
              `).join('')\}
            </div>
          </div>
        `;
        container.appendChild(row);
      \});
    \}

    // Generate Part 3 Questions
    function generatePart3Questions() \{
      const container = document.getElementById('part3-questions');
      container.innerHTML = '';
      
      part3Questions.forEach((question, index) => \{
        const questionNum = index + 1;
        const row = document.createElement('div');
        row.className = 'question-row p-4 border-b border-gray-100 last:border-b-0';
        row.innerHTML = `
          <div class="flex flex-col lg:flex-row lg:items-center gap-4">
            <div class="flex-1">
              <span class="font-medium text-gray-800">$\{questionNum\}. </span>
              <span class="text-gray-700">$\{question\}</span>
            </div>
            <div class="flex gap-2 justify-end flex-shrink-0">
              $\{[1,2,3,4,5].map(score => `
                <label class="likert-option cursor-pointer">
                  <input type="radio" name="p3q$\{questionNum\}" value="$\{score\}" class="sr-only" onchange="updatePart3Score($\{questionNum\}, $\{score\})">
                  <div class="w-10 h-10 rounded-full border-2 border-gray-300 flex items-center justify-center text-sm font-bold text-gray-500 hover:border-emerald-500 hover:text-emerald-600 transition-all $\{getScoreColor(score, 5)\}">
                    $\{score\}
                  </div>
                </label>
              `).join('')\}
            </div>
          </div>
        `;
        container.appendChild(row);
      \});
    \}

    function getScoreColor(score, max) \{
      if (max === 6) \{
        const colors = ['bg-gray-100', 'bg-red-50', 'bg-orange-50', 'bg-yellow-50', 'bg-lime-50', 'bg-green-50'];
        return colors[score] || '';
      \} else \{
        const colors = ['', 'bg-red-50', 'bg-orange-50', 'bg-yellow-50', 'bg-lime-50', 'bg-green-50'];
        return colors[score] || '';
      \}
    \}

    function updatePart2Score(questionNum, score) \{
      part2Scores[questionNum] = score;
      
      const inputs = document.querySelectorAll(`input[name="p2q$\{questionNum\}"]`);
      inputs.forEach(input => \{
        const parent = input.parentElement;
        const div = parent.querySelector('div');
        if (parseInt(input.value) === score) \{
          div.classList.add('selected', 'border-teal-500', 'bg-teal-500', 'text-white');
          div.classList.remove('border-gray-300', 'text-gray-500');
        \} else \{
          div.classList.remove('selected', 'border-teal-500', 'bg-teal-500', 'text-white');
          div.classList.add('border-gray-300', 'text-gray-500');
        \}
      \});

      updatePart2Average();
    \}

    function updatePart3Score(questionNum, score) \{
      part3Scores[questionNum] = score;
      
      const inputs = document.querySelectorAll(`input[name="p3q$\{questionNum\}"]`);
      inputs.forEach(input => \{
        const parent = input.parentElement;
        const div = parent.querySelector('div');
        if (parseInt(input.value) === score) \{
          div.classList.add('selected', 'border-emerald-500', 'bg-emerald-500', 'text-white');
          div.classList.remove('border-gray-300', 'text-gray-500');
        \} else \{
          div.classList.remove('selected', 'border-emerald-500', 'bg-emerald-500', 'text-white');
          div.classList.add('border-gray-300', 'text-gray-500');
        \}
      \});

      updatePart3Average();
    \}

    function updatePart2Average() \{
      const scores = Object.values(part2Scores);
      if (scores.length === 0) return;
      
      const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
      document.getElementById('part2-avg').textContent = avg.toFixed(2);
      document.getElementById('part2-bar').style.width = `$\{(avg / 5) * 100\}%`;
    \}

    function updatePart3Average() \{
      const scores = Object.values(part3Scores);
      if (scores.length === 0) return;
      
      const avg = scores.reduce((a, b) => a + b, 0) / scores.length;
      document.getElementById('part3-avg').textContent = avg.toFixed(2);
      document.getElementById('part3-bar').style.width = `$\{(avg / 5) * 100\}%`;
    \}

    function goToSection(sectionNum) \{
      if (sectionNum > currentSection) \{
        if (!validateSection(currentSection)) \{
          return;
        \}
      \}

      document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
      
      const targetSection = document.getElementById(`section$\{sectionNum\}`);
      if (targetSection) \{
        targetSection.classList.remove('hidden');
        currentSection = sectionNum;
        
        const progress = (sectionNum / 3) * 100;
        document.getElementById('progress-bar').style.width = `$\{progress\}%`;
        document.getElementById('progress-text').textContent = `ส่วนที่ $\{sectionNum\} / 3`;
        
        window.scrollTo(\{ top: 0, behavior: 'smooth' \});
      \}
    \}

    function validateSection(sectionNum) \{
      if (sectionNum === 1) \{
        const requiredFields = [
          \{ name: 'gender', label: 'เพศ' \},
          \{ name: 'age', label: 'อายุ', type: 'input' \},
          \{ name: 'marital', label: 'สถานภาพสมรส' \},
          \{ name: 'education', label: 'ระดับการศึกษา' \},
          \{ name: 'hospital', label: 'ระดับโรงพยาบาล' \},
          \{ name: 'position', label: 'ตำแหน่งงาน' \},
          \{ name: 'experience', label: 'ประสบการณ์', type: 'input' \},
          \{ name: 'palliative_exp', label: 'ประสบการณ์ดูแลประคับประคอง' \},
          \{ name: 'palliative_training', label: 'การอบรมดูแลประคับประคอง' \}
        ];

        for (const field of requiredFields) \{
          if (field.type === 'input') \{
            const input = document.querySelector(`input[name="$\{field.name\}"]`);
            if (!input || !input.value.trim()) \{
              showToast(`กรุณากรอก$\{field.label\}`);
              return false;
            \}
          \} else \{
            const checked = document.querySelector(`input[name="$\{field.name\}"]:checked`);
            if (!checked) \{
              showToast(`กรุณาเลือก$\{field.label\}`);
              return false;
            \}
          \}
        \}
      \} else if (sectionNum === 2) \{
        const answeredCount = Object.keys(part2Scores).length;
        if (answeredCount < part2Questions.length) \{
          showToast(`กรุณาตอบคำถามส่วนที่ 2 ให้ครบทุกข้อ (ตอบแล้ว $\{answeredCount\}/$\{part2Questions.length\} ข้อ)`);
          return false;
        \}
      \}
      return true;
    \}

    function showToast(message, isError = true) \{
      const toast = document.getElementById('toast');
      const toastMessage = document.getElementById('toast-message');
      
      toast.className = `fixed bottom-4 right-4 $\{isError ? 'bg-red-500' : 'bg-green-500'\} text-white px-6 py-3 rounded-xl shadow-lg transform transition-all duration-300 z-50`;
      toastMessage.textContent = message;
      toast.classList.remove('translate-y-20', 'opacity-0');
      
      setTimeout(() => \{
        toast.classList.add('translate-y-20', 'opacity-0');
      \}, 3000);
    \}

    async function submitForm() \{
      const answeredCount = Object.keys(part3Scores).length;
      if (answeredCount < part3Questions.length) \{
        showToast(`กรุณาตอบคำถามส่วนที่ 3 ให้ครบทุกข้อ (ตอบแล้ว $\{answeredCount\}/$\{part3Questions.length\} ข้อ)`);
        return;
      \}

      document.getElementById('loading-overlay').classList.remove('hidden');
      document.getElementById('submit-btn').disabled = true;

      const formData = \{
        submission_id: 'SUB-' + Date.now(),
        submitted_at: new Date().toISOString(),
        assessment_period: assessmentPeriod,
        gender: document.querySelector('input[name="gender"]:checked')?.value || '',
        age: document.querySelector('input[name="age"]')?.value || '',
        marital_status: document.querySelector('input[name="marital"]:checked')?.value || '',
        marital_other: document.querySelector('input[name="marital_other"]')?.value || '',
        education: document.querySelector('input[name="education"]:checked')?.value || '',
        hospital_level: document.querySelector('input[name="hospital"]:checked')?.value || '',
        hospital_other: document.querySelector('input[name="hospital_other"]')?.value || '',
        position: document.querySelector('input[name="position"]:checked')?.value || '',
        position_other: document.querySelector('input[name="position_other"]')?.value || '',
        experience_years: document.querySelector('input[name="experience"]')?.value || '',
        palliative_experience: document.querySelector('input[name="palliative_exp"]:checked')?.value || '',
        palliative_training: document.querySelector('input[name="palliative_training"]:checked')?.value || '',
        training_course: document.querySelector('input[name="training_course"]')?.value || '',
        part2_scores: JSON.stringify(part2Scores),
        part2_average: Object.values(part2Scores).reduce((a, b) => a + b, 0) / Object.values(part2Scores).length,
        part3_scores: JSON.stringify(part3Scores),
        part3_average: Object.values(part3Scores).reduce((a, b) => a + b, 0) / Object.values(part3Scores).length
      \};

      try \{
        if (window.dataSdk) \{
          const result = await window.dataSdk.create(formData);
          if (result.isOk) \{
            showSuccess(formData.part2_average, formData.part3_average);
          \} else \{
            showToast('เกิดข้อผิดพลาดในการบันทึกข้อมูล กรุณาลองใหม่อีกครั้ง');
          \}
        \} else \{
          showSuccess(formData.part2_average, formData.part3_average);
        \}
      \} catch (error) \{
        showToast('เกิดข้อผิดพลาด กรุณาลองใหม่อีกครั้ง');
      \} finally \{
        document.getElementById('loading-overlay').classList.add('hidden');
        document.getElementById('submit-btn').disabled = false;
      \}
    \}

    function showSuccess(part2Avg, part3Avg) \{
      document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
      document.getElementById('success-section').classList.remove('hidden');
      document.getElementById('final-part2').textContent = part2Avg.toFixed(2);
      document.getElementById('final-part3').textContent = part3Avg.toFixed(2);
      document.getElementById('period-confirmation').textContent = `ระยะเวลาประเมิน: $\{assessmentPeriod\}`;
      document.getElementById('progress-bar').style.width = '100%';
      document.getElementById('progress-text').textContent = 'เสร็จสิ้น';
      window.scrollTo(\{ top: 0, behavior: 'smooth' \});
    \}

    function resetForm() \{
      document.querySelectorAll('input[type="radio"]').forEach(r => r.checked = false);
      document.querySelectorAll('input[type="text"], input[type="number"]').forEach(i => i.value = '');
      
      part2Scores = \{\};
      part3Scores = \{\};
      
      document.querySelectorAll('.likert-option div').forEach(div => \{
        div.classList.remove('selected', 'border-teal-500', 'bg-teal-500', 'border-emerald-500', 'bg-emerald-500', 'text-white');
        div.classList.add('border-gray-300', 'text-gray-500');
      \});
      
      document.getElementById('part2-avg').textContent = '-';
      document.getElementById('part2-bar').style.width = '0%';
      document.getElementById('part3-avg').textContent = '-';
      document.getElementById('part3-bar').style.width = '0%';
      
      document.querySelectorAll('input[name="marital_other"], input[name="hospital_other"], input[name="position_other"]').forEach(el => \{
        el.classList.add('hidden');
      \});
      document.getElementById('training-course-wrapper').classList.add('hidden');
      
      assessmentPeriod = '';
      document.getElementById('period-modal').classList.remove('hidden');
      goToSection(1);
    \}

    function setupConditionalFields() \{
      document.querySelectorAll('input[name="marital"]').forEach(radio => \{
        radio.addEventListener('change', function() \{
          const otherField = document.querySelector('input[name="marital_other"]');
          if (this.value === 'อื่นๆ') \{
            otherField.classList.remove('hidden');
          \} else \{
            otherField.classList.add('hidden');
            otherField.value = '';
          \}
        \});
      \});

      document.querySelectorAll('input[name="hospital"]').forEach(radio => \{
        radio.addEventListener('change', function() \{
          const otherField = document.querySelector('input[name="hospital_other"]');
          if (this.value === 'อื่นๆ') \{
            otherField.classList.remove('hidden');
          \} else \{
            otherField.classList.add('hidden');
            otherField.value = '';
          \}
        \});
      \});

      document.querySelectorAll('input[name="position"]').forEach(radio => \{
        radio.addEventListener('change', function() \{
          const otherField = document.querySelector('input[name="position_other"]');
          if (this.value === 'อื่นๆ') \{
            otherField.classList.remove('hidden');
          \} else \{
            otherField.classList.add('hidden');
            otherField.value = '';
          \}
        \});
      \});

      document.querySelectorAll('input[name="palliative_training"]').forEach(radio => \{
        radio.addEventListener('change', function() \{
          const courseWrapper = document.getElementById('training-course-wrapper');
          if (this.value === 'เคย') \{
            courseWrapper.classList.remove('hidden');
          \} else \{
            courseWrapper.classList.add('hidden');
            document.querySelector('input[name="training_course"]').value = '';
          \}
        \});
      \});
    \}

    async function onConfigChange(newConfig) \{
      config = \{ ...defaultConfig, ...newConfig \};
      
      const titleEl = document.getElementById('main-title');
      if (titleEl) titleEl.textContent = config.form_title || defaultConfig.form_title;
      
      const orgEl = document.getElementById('org-name');
      if (orgEl) orgEl.textContent = config.organization_name || '';
    \}

    function mapToCapabilities(config) \{
      return \{
        recolorables: [
          \{
            get: () => config.primary_color || defaultConfig.primary_color,
            set: (value) => \{ config.primary_color = value; if (window.elementSdk) window.elementSdk.setConfig(\{ primary_color: value \}); \}
          \},
          \{
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => \{ config.background_color = value; if (window.elementSdk) window.elementSdk.setConfig(\{ background_color: value \}); \}
          \},
          \{
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => \{ config.text_color = value; if (window.elementSdk) window.elementSdk.setConfig(\{ text_color: value \}); \}
          \}
        ],
        borderables: [],
        fontEditable: undefined,
        fontSizeable: undefined
      \};
    \}

    function mapToEditPanelValues(config) \{
      return new Map([
        ['form_title', config.form_title || defaultConfig.form_title],
        ['organization_name', config.organization_name || defaultConfig.organization_name]
      ]);
    \}

    async function init() \{
      setupConditionalFields();
      
      if (window.elementSdk) \{
        window.elementSdk.init(\{
          defaultConfig,
          onConfigChange,
          mapToCapabilities,
          mapToEditPanelValues
        \});
      \}

      if (window.dataSdk) \{
        const dataHandler = \{
          onDataChanged(data) \{
            console.log('Total submissions:', data.length);
          \}
        \};
        
        const result = await window.dataSdk.init(dataHandler);
        if (!result.isOk) \{
          console.error('Failed to initialize data SDK');
        \}
      \}
    \}

    init();
  </script>
 <script>(function()\{function c()\{var b=a.contentDocument||a.contentWindow.document;if(b)\{var d=b.createElement('script');d.innerHTML="window.__CF$cv$params=\{r:'9cebd621f4daa459',t:'MTc3MTIzMjIzNi4wMDAwMDA='\};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)\}\}if(document.body)\{var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else\{var e=document.onreadystatechange||function()\{\};document.onreadystatechange=function(b)\{e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())\}\}\}\})();</script></body>
</html>
